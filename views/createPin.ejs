<% include ./partials/header.ejs %>
<%- include('./partials/navbar.ejs', { nav: true })%>

<!-- Create Pin Header -->
<div class="bg-white shadow-md p-4 mb-2 mt-16">
  <h1 class="text-2xl font-bold text-center">Create Pin</h1>
</div>

<!-- Create Pin Form -->
<div class="flex items-center justify-center min-[50vh] mt-10">
  <form action="/create-pin" method="POST" enctype="multipart/form-data" 
        class="bg-white p-6 rounded-lg shadow-lg w-full max-w-6xl space-y-6 lg:space-y-0 lg:flex lg:gap-8 m-2">

    <!-- Left Side: Drag & Drop -->
    <div class="flex-1">
      <div id="drag-area" 
           class="drag-area border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer h-full flex flex-col items-center justify-center">
        
        <!-- Placeholder (text + icon) -->
        <div id="placeholder">
          <p class="text-gray-500">Choose an image</p>
          <i class="ri-arrow-up-circle-line text-3xl text-gray-400"></i>
        </div>

        <input type="file" name="image" id="file-input" hidden required>
        <img id="preview" class="hidden mt-4 rounded-lg max-h-80 mx-auto"/>
      </div>
    </div>

    <!-- Right Side: Inputs -->
    <div class="flex-1 space-y-4">
      <!-- Title -->
      <label class="font-medium text-black" for="title">Title</label>
      <input type="text" name="title" placeholder="Title" 
             class="w-full rounded-xl border border-gray-300 px-3 py-2" required>

      <!-- Description -->
      <label class="font-medium text-black" for="description">Description</label>
      <textarea name="description" placeholder="Description" rows="5"
                class="w-full rounded-xl border border-gray-300 px-3 py-2"></textarea>

      <!-- Category -->
      <label class="font-medium text-black" for="category">Category</label>
      <input type="text" name="category" placeholder="Category" 
             class="w-full rounded-xl border border-gray-300 px-3 py-2" required>

      <!-- Publish Button -->
      <button type="submit" 
              class="bg-red-500 text-white w-full py-2 rounded-lg hover:bg-red-600 transition">
        Publish
      </button>
    </div>
  </form>
</div>


<script>
const dragArea = document.getElementById("drag-area");
const input = document.getElementById("file-input");
const preview = document.getElementById("preview");
const placeholder = document.getElementById("placeholder");

dragArea.addEventListener("click", () => input.click());
input.addEventListener("change", () => previewFile(input.files[0]));

dragArea.addEventListener("dragover", (e) => {
  e.preventDefault();
  dragArea.classList.add("bg-indigo-50", "border-indigo-500");
});
dragArea.addEventListener("dragleave", () => {
  dragArea.classList.remove("bg-indigo-50", "border-indigo-500");
});
dragArea.addEventListener("drop", (e) => {
  e.preventDefault();
  dragArea.classList.remove("bg-indigo-50", "border-indigo-500");
  input.files = e.dataTransfer.files;
  previewFile(input.files[0]);
});

function previewFile(file) {
  const reader = new FileReader();
  reader.onload = () => {
    preview.src = reader.result;
    preview.classList.remove("hidden");
    placeholder.classList.add("hidden"); // âœ… hide text + icon
  };
  reader.readAsDataURL(file);
}
</script>


<% include ./partials/footer.ejs %>
